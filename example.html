<!doctype html>
<body>
<h1>Example of a bookmarklet</h1>
<p>Drag and drop this puppy onto your bookmarks bar</p>
<a href="javascript:var SUBMISSION_URL=&quot;https://script.google.com/macros/s/AKfycbzMERYMJ3QI7-gjmP9R6BDttfv0UyJ3TAIbe0fpyxJ_luJW0q87/exec&quot;;var FIELDS={&quot;&quot;:&quot;...&quot;,&quot;ciceroID&quot;:&quot;ciceroID&quot;,&quot;legState&quot;:&quot;legState&quot;,&quot;district&quot;:&quot;district&quot;,&quot;legFirst&quot;:&quot;legFirst&quot;,&quot;legLast&quot;:&quot;legLast&quot;,&quot;notes&quot;:&quot;notes&quot;,&quot;testresult&quot;:&quot;testresult&quot;,&quot;emailconfirmed&quot;:&quot;emailconfirmed&quot;,&quot;impossible&quot;:&quot;impossible&quot;,&quot;sendcontenttype&quot;:&quot;sendcontenttype&quot;,&quot;sendallowredirect&quot;:&quot;sendallowredirect&quot;,&quot;crawlfirst&quot;:&quot;crawlfirst&quot;,&quot;passes&quot;:&quot;passes&quot;,&quot;method&quot;:&quot;method&quot;,&quot;prefixF&quot;:&quot;prefixF&quot;,&quot;firstnameF&quot;:&quot;firstnameF&quot;,&quot;lastnameF&quot;:&quot;lastnameF&quot;,&quot;addressF&quot;:&quot;addressF&quot;,&quot;cityF&quot;:&quot;cityF&quot;,&quot;stateF&quot;:&quot;stateF&quot;,&quot;stateDV&quot;:&quot;stateDV&quot;,&quot;zip5F&quot;:&quot;zip5F&quot;,&quot;zip5confirmF&quot;:&quot;zip5confirmF&quot;,&quot;zip4F&quot;:&quot;zip4F&quot;,&quot;phoneF&quot;:&quot;phoneF&quot;,&quot;phoneconfirmF&quot;:&quot;phoneconfirmF&quot;,&quot;emailF&quot;:&quot;emailF&quot;,&quot;emailConfirmF&quot;:&quot;emailConfirmF&quot;,&quot;responseF&quot;:&quot;responseF&quot;,&quot;newsletterF&quot;:&quot;newsletterF&quot;,&quot;issueF&quot;:&quot;issueF&quot;,&quot;issue-guns&quot;:&quot;issue-guns&quot;,&quot;issue-education&quot;:&quot;issue-education&quot;,&quot;issue-gays&quot;:&quot;issue-gays&quot;,&quot;issue-women&quot;:&quot;issue-women&quot;,&quot;issue-immigration&quot;:&quot;issue-immigration&quot;,&quot;subjectF&quot;:&quot;subjectF&quot;,&quot;messageF&quot;:&quot;messageF&quot;,&quot;submitF&quot;:&quot;submitF&quot;,&quot;submitV&quot;:&quot;submitV&quot;,&quot;successString&quot;:&quot;successString&quot;,&quot;dtlastupdate&quot;:&quot;dtlastupdate&quot;};var data={};data.formID=prompt(&quot;Please enter the form ID&quot;);var body=document.getElementsByTagName(&quot;body&quot;)[0];var ON,YES=ON=true;var NO,OFF=NO=false;var color_highlighted=&quot;#ff0&quot;;var color_selected=&quot;#00ff00&quot;;function addEvent(elem,event,fn){function listenHandler(e){var ret=fn.apply(this,arguments);if(ret===false){e.stopPropagation();e.preventDefault()}return(ret)}function attachHandler(){var ret=fn.call(elem,window.event);if(ret===false){window.event.returnValue=false;window.event.cancelBubble=true}return(ret)}if(elem.addEventListener){elem.addEventListener(event,listenHandler,false)}else{elem.attachEvent(&quot;on&quot;+event,attachHandler)}}function valid(target){return target.name!==undefined&&!/exception/.test(target.className)}addEvent(body,&quot;mouseover&quot;,function(e){var target=e.srcElement;if(valid(target)){highlight(target,ON)}});addEvent(body,&quot;mouseout&quot;,function(e){var target=e.srcElement;if(valid(target)){highlight(target,OFF)}});addEvent(body,&quot;mousedown&quot;,function(e){var target=e.srcElement;if(valid(target)){e.preventDefault();if(selected(target)){removeDialogue(e)}else{addDialogue(e)}}else{if(!/exception/.test(target.className)){modal.remove()}}});function selected(ele,state){if(state===undefined){return ele.__selected?YES:NO}else{if(state==YES){ele.style.background=color_selected;ele.style.outline=&quot;1px solid &quot;+color_selected;ele.__selected=YES}else{ele.style.background=&quot;&quot;;ele.style.outline=&quot;&quot;;ele.__selected=NO}}}function highlight(ele,state){if(state===undefined){return ele.__highlighted?YES:NO}else{if(state==YES){ele.style.outline=&quot;5px solid &quot;+color_highlighted}else{if(selected(ele)){ele.style.outline=&quot;1px solid &quot;+color_selected}else{ele.style.outline=&quot;&quot;}}}}var modal;var selected_elements=[];var element_type=[];function createModal(e){modal=document.createElement(&quot;div&quot;);modal.id=&quot;modal&quot;;modal.style.position=&quot;absolute&quot;;modal.style.background=&quot;#fcfcfc&quot;;modal.style.border=&quot;2px solid #555&quot;;modal.style.padding=&quot;10px&quot;;modal.style.zIndex=&quot;1000&quot;;modal.style.left=(e.pageX-30)+&quot;px&quot;;modal.style.top=(e.pageY-40)+&quot;px&quot;}function addDialogue(e){createModal(e);modal.innerHTML=&quot;<div>What type of input is this?</div>&quot;;var select=document.createElement(&quot;select&quot;);select.className=&quot;exception&quot;;for(var prop in FIELDS){var option=document.createElement(&quot;option&quot;);option.value=prop;option.innerHTML=FIELDS[prop];select.appendChild(option)}modal.appendChild(select);addEvent(select,&quot;change&quot;,function(){var selected_element=e.srcElement;selected_elements.push(selected_element);element_type.push(select.value);selected(selected_element,YES);modal.remove()});body.appendChild(modal)}function removeDialogue(e){createModal(e);modal.innerHTML=&quot;<div>Remove this field?</div>&quot;;var yes=document.createElement(&quot;input&quot;);yes.className=&quot;exception&quot;;yes.type=&quot;button&quot;;yes.value=&quot;Yes&quot;;var no=document.createElement(&quot;input&quot;);no.className=&quot;exception&quot;;no.type=&quot;button&quot;;no.value=&quot;No&quot;;modal.appendChild(yes);modal.appendChild(no);addEvent(yes,&quot;click&quot;,function(){var index=selected_elements.indexOf(e.srcElement);selected_elements.splice(index,1);element_type.splice(index,1);selected(e.srcElement,NO);modal.remove()});addEvent(no,&quot;click&quot;,function(){modal.remove()});body.appendChild(modal)}data.url=location.href;var actions=[];var forms=document.getElementsByTagName(&quot;form&quot;);for(var i=0,ilen=forms.length;i<ilen;i++){var temp=document.createElement(&quot;div&quot;);temp.appendChild(forms[i].cloneNode());actions.push(temp.innerHTML)}data.actions=actions.join(&quot;\n&quot;);var hidden=[];var inputs=document.getElementsByTagName(&quot;input&quot;);for(var i=0,ilen=inputs.length;i<ilen;i++){var input=inputs[i];if(input.type&&input.type.toLowerCase()==&quot;hidden&quot;){hidden.push(input.name+&quot;=&quot;+input.value)}}data.hidden=hidden.join(&quot;\n&quot;);var http=new XMLHttpRequest;http.open(&quot;POST&quot;,SUBMISSION_URL,true);http.setRequestHeader(&quot;Content-type&quot;,&quot;application/x-www-form-urlencoded&quot;);function encodedData(){for(var i=0,ilen=selected_elements.length;i<ilen;i++){var ele=selected_elements[i];var type=element_type[i];if(data[type]===undefined){data[type]=&quot;&quot;}if(ele.tagName==&quot;SELECT&quot;){var opts=ele.options;var name=ele.name;data[type]+=&quot;SELECT &quot;+ele.name+&quot;\n&quot;;for(var j=0,jlen=opts.length;j<ilen;j++){var option=opts[j];data[type]+=option.innerText+&quot;=&quot;+option.value+&quot;\n&quot;}}else{data[type]+=ele.name+&quot;=&quot;+ele.value+&quot;\n&quot;}}return serialize(data)}function serialize(obj){var token=[];for(var k in obj){token.push(encodeURIComponent(k)+&quot;=&quot;+encodeURIComponent(obj[k]))}return token.join(&quot;&&quot;)}document.onkeydown=function(e){var enter=13;if(e&&e.keyCode==enter){http.send(encodedData());alert(&quot;Data Sent!&quot;)}};">Data Miner</a>
</body>